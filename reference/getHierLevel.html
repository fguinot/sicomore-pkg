<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>getHierLevel — getHierLevel • sicomore</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="getHierLevel — getHierLevel" />
<meta property="og:description" content="A function to select groups of variables which are good at predicting a given phenotype.
The groups considered corresponds to various cut levels in a user defined hierarchy.
The selection is performed by various penalty-based regression methods (weighted-LASSO or group-LASSO)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sicomore</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2-9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a>
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/singleData.html">Analysis of a single data set</a>
    </li>
    <li>
      <a href="../articles/twoDataInteraction.html">Analysis of two interacting data sets</a>
    </li>
    <li>
      <a href="../articles/twoDataInteraction.html">Analysis of the MEtaRhizosphere data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/fguinot/sicomore-pkg">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>getHierLevel</h1>
    <small class="dont-index">Source: <a href='https://github.com/jchiquet/sicomore-pkg/blob/master/R/getHierLevel.R'><code>R/getHierLevel.R</code></a></small>
    <div class="hidden name"><code>getHierLevel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A function to select groups of variables which are good at predicting a given phenotype.
The groups considered corresponds to various cut levels in a user defined hierarchy.
The selection is performed by various penalty-based regression methods (weighted-LASSO or group-LASSO).</p>
    </div>

    <pre class="usage"><span class='fu'>getHierLevel</span>(
  <span class='no'>X</span>,
  <span class='no'>y</span>,
  <span class='no'>hc.object</span>,
  <span class='kw'>selection</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"rho-sicomore"</span>, <span class='st'>"sicomore"</span>, <span class='st'>"mlgl"</span>),
  <span class='kw'>compression</span> <span class='kw'>=</span> <span class='st'>"mean"</span>,
  <span class='kw'>depth.cut</span> <span class='kw'>=</span> <span class='fl'>3</span>,
  <span class='kw'>choice</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"lambda.min"</span>, <span class='st'>"lambda.1se"</span>),
  <span class='kw'>mc.cores</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>stab</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>stab.param</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>B</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>100</span>, <span class='fl'>100</span>), <span class='kw'>cutoff</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.75</span>, <span class='fl'>0.75</span>), <span class='kw'>PFER</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>))
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>input matrix</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>response variable</p></td>
    </tr>
    <tr>
      <th>hc.object</th>
      <td><p>output of a hierarchical clustering algorithm in the <code>hclust</code> format (must be an "hclust" object)</p></td>
    </tr>
    <tr>
      <th>selection</th>
      <td><p>method used to perform variable selection. Either 'sicomore', 'rho-sicomore'  or 'mlgl' (see details). Default is 'rho-sicomore'.</p></td>
    </tr>
    <tr>
      <th>compression</th>
      <td><p>a string (either "mean" or "SNP.dist"). Indicates how groups of variables are compressed before variable selection is performed at each level of the hierarchy. Only relevant for 'sicomore' or 'rho-sicomore'.</p></td>
    </tr>
    <tr>
      <th>depth.cut</th>
      <td><p>an integer specifying the depth of the search space for the variable selection part of the algorithm.
This argument allows to increase the speed of the algorithm by restraining the search space without affecting too much the performance.
A value between 3 and 6 is recommended, the smaller the faster.</p></td>
    </tr>
    <tr>
      <th>choice</th>
      <td><p>a string (either "lambda.min" or "lambda.1se"). Indicates how the tuning parameter is chosen in the penalized regression approach</p></td>
    </tr>
    <tr>
      <th>mc.cores</th>
      <td><p>an integer for the number of cores to use in the parallelization of the cross-validation and some other functions. Default is 1.</p></td>
    </tr>
    <tr>
      <th>stab</th>
      <td><p>A boolean indicating if the algorithm perform a lasso stability selection using stabsel function from stabs package.</p></td>
    </tr>
    <tr>
      <th>stab.param</th>
      <td><p>A list of parameter for the stabsel function if stab = TRUE.
The parameters to choose are the FWER (1 by default), cut-off (0.75 by default) and bootstrap number (200 by default).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an RC object with class 'sicomore-model', with methods <code>nGrp()</code>, <code>nVar()</code>, <code>getGrp()</code>, <code>getVar()</code>, <code>getCV()</code>, <code>getX.comp()</code>, <code>getCoef()</code> and with the following fields:</p><ul>
<li><p>groups:a list with the selected groups of predictors</p></li>
<li><p>coefficients:a vector with the estimated coefficients (one per selected group) if stab=FALSE</p></li>
<li><p>X.comp:The compressed version of the original input matrix (as many columns as number of selected groups)</p></li>
<li><p>cv.error:for the best grouping, a data frame showing the cross-validation error used in the variable selection procedure if stab=FALSE</p></li>
<li><p>selection:the selection method used</p></li>
<li><p>compression:the compression method used</p></li>
<li><p>group_inference:the group selection infered by "lasso" or "hclust" if no selection by lasso.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The methods for variable selection are variants of the LASSO or the group-LASSO designed to perform selection of interaction between multiple hierarchies:
'sicomore' and 'rho-sicomore' (see Ambroise et al. (2018)
, Park et al. (2007)
) use a LASSO penalty on compressed groups of variables along the hierarchies to select the
interactions. The rho-sicomore variant is a weighted version of sicomore, which weights depend on the levels in the hierarchies. The method 'mlgl' of Grimonprez (2016)

uses a weigthed group-Lasso penalty which does not require compression but is more computationally demanding.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ambroise C, Chiquet J, Guinot F, Szafranski M (2018).
&#8220;Fast Computation of Genome-Metagenome Interaction Effects.&#8221;
<em>arXiv preprint arXiv:1810.12169</em>.<br /><br /> Grimonprez Q (2016).
<em>Selection de groupes de variables corrélées en grande dimension</em>.
Ph.D. thesis, Université de Lille.<br /><br /> Park MY, Hastie T, Tibshirani R (2007).
&#8220;Averaged gene expressions for regression.&#8221;
<em>Biostatistics</em>, <b>8</b>(2), 212--227.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Christophe Ambroise, Julien Chiquet, Florent Guinot, Marie Szafranski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


